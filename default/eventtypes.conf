# Copyright (C) 2009-2012 Splunk Inc. All Rights Reserved.
# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA-nix/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA-nix/default
# into ../local and edit there.
#

###### Globals ######

[nix_configs]
search = source="/etc/*" OR source="*.conf" OR source="*.cfg" 

[nix_errors]
search = NOT sourcetype=stash error OR critical OR failure OR fail OR failed OR fatal
#tags = error


###### Scripted Inputs ######
## CPU stats
[solaris_cpu]
search = sourcetype=solaris:cpu
#tags = performance os resource report unix cpu

[solaris_cpu_anomalous]
search = sourcetype=solaris:cpu cpu_load_percent>90
#tags = enabled

[solaris_mem_anomalous]
search = sourcetype=solaris_vmstat memFreePct < 20

[solaris_df]
search = sourcetype=solaris:df
#tags = df host check success storage performance

[solaris_df_anomalous]
search = sourcetype=solaris_df UsePct > 85

[solaris_hardware]
search = sourcetype=solaris:hardware

[solaris_interfaces]
search = sourcetype=solaris:interfaces

[solaris_iostat]
search = sourcetype=solaris:iostat

[solaris_lastlog]
search = sourcetype=solaris:lastlog

[solaris_lsof]
search = sourcetype=solaris:lsof

[solaris_netstat]
search = sourcetype=solaris:netstat

[solaris_openPorts]
search = sourcetype=solaris:openPorts

[solaris_openPortsEnhanced]
search = sourcetype=solaris:openPortsEnhanced

[solaris_package]
search = sourcetype=solaris:package

## User Accounts -- passwd.sh
[solaris_useraccounts]
search = sourcetype=solaris:useraccounts
#tags = (os) config user inventory

[solaris_protocol]
search = sourcetype=solaris:protocol

[solaris_ps]
search = sourcetype=solaris:ps
#tags = report process os success ps

## Service
[solaris_service]
search = sourcetype=solaris:service

## SSHD Config
[solaris_sshdconfig]
search = sourcetype=solaris:sshdconfig
#tags = application config ssh

[solaris_time]
search = sourcetype=solaris:time

[solaris_top]
search = sourcetype=solaris:top

## Update
[solaris_update]
search = sourcetype=solaris:update
#tags = os info update 

## Uptime
[solaris_uptime]
search = solaris:uptime
#tags = os info report uptime performance

[solaris_usersWithLoginPrivs]
search = sourcetype=solaris:usersWithLoginPrivs

## Version
[solaris_version]
search = sourcetype=solaris:version
#tags = os info report system version inventory

[solaris_vmstat]
search = sourcetype=solaris:vmstat
#tags = performance os avail unix report vmstat resource success memory

[solaris_who]
search = sourcetype=solaris:who


###### System Logs ######

#### Account Management

#### acpi
[nix_acpi]
search = NOT sourcetype=stash ACPI:
#tags = os unix power


#### agpgart
[nix_agpgart]
search = NOT sourcetype=stash agpgart:
#tags = os unix graphics


#### apm 
[nix_apm]
search = NOT sourcetype=stash apm:
#tags = os unix power


#### auditd
[auditd]
search = (sourcetype=auditd OR sourcetype=solaris:auditd)
#tags = os unix resource file

[auditd_modify]
search = source=auditd PATH
#tags = modify


#### automount
[nix_automount]
search = automount punct="::__::_*:_*"
#tags = os unix


#### Config
[nix_config_change]
search = NOT sourcetype=stash Configuration changed
#tags = os unix host configuration modify


#### Console
[nix_console]
search = NOT sourcetype=stash Console:
#tags = os unix


#### cron
[nix_cron]
search = cron OR crond punct="::__::_*:_*" NOT Install: NOT Updated: NOT Erased:
#tags = os unix


#### CUPS
[nix_cups_access]
search = punct="_-_-_[//:::_-]_\"_//._/.\"___-_-"
#tags = os unix access printer

[nix_cups_error]
search = punct="_[//:::_-]_*"
#tags = os unix printer

[nix_cups_page]
search = punct="___[//:::_-]___-_"
#tags = os unix printer


#### dhclient
[nix_dhclient]
search = dhclient punct="__::_*:_*" NOT punct="//_::_*:_*." NOT punct="\"///*\"" NOT Rule NOT Name
#tags = os unix


#### DMA
[nix_dma]
search = NOT sourcetype=stash DMA zone:
#tags = os unix memory access

#### FTP
[nix_ftp_xferlog]
search = punct="___*::___...__///*"
#tags = os unix ftp transfer

[nix_ncftpd_logins]
search = ncftpd punct="__::_*:_*"
#tags = os unix ftp authentication


#### Fingerprinting
[nix_fingerprinting]
search = NOT sourcetype=stash Client OS detected:
#tags = os unix


#### kernel
[nix_kernel_attached]
search = NOT sourcetype=stash kernel
#tags = os unix kernel


#### kill
[nix_process_kill]
search = NOT sourcetype=stash exiting signal 15
#tags = os unix process stop


#### mDNSResponder
[nix_mDNSResponder]
search = mDNSResponder punct="__::_*:_*"
#tags = os unix dns


#### named
[nix_named1]
search = named punct="__::_/_[]:__*" OR punct="__::_..._[]:_*"
#tags = os unix dns

[nix_named2]
search = named punct="__::_*_[]:__*" NOT punct="__::_*_[]:_____..."
#tags = os unix dns


#### PCI
[nix_pci]
search = NOT sourcetype=stash PCI: NOT BIOS
#tags = os unix



#### POP3
[nix_popper]
search = NOT sourcetype=stash popper
#tags = os unix mail


#### postfix
[nix_postfix]
search = postfix punct="__::_*:_*"
#tags = os unix


#### RPC
[nix_rpc_statd]
search = NOT sourcetype=stash rpc.statd
#tags = os unix


#### Runlevel
[nix_runlevel_change]
search = init: punct="__::_*:_*"
#tags = os unix configuration modify


#### SNMPD
[snmpd]
search = NOT sourcetype=stash snmpd
#tags = os unix snmp

[snmpd_failure]
search = NOT sourcetype=stash snmpd SNMPD_*_FAILURE
#tags = failure


## Shutdown
[nix_halt]
search = NOT sourcetype=stash shutdown: system halt
#tags = os unix stop

[nix_restart]
search = NOT sourcetype=stash shutdown: system reboot
#tags = os unix stop


#### USB
[nix_usb]
search = NOT sourcetype=stash usb*: NOT punct="<>:__*"
#tags = os unix usb


###### ADDED FROM UNIX APP ######
[failed_login]
search = "failed login" OR "FAILED LOGIN" OR "Authentication failure"  OR "Failed to authenticate user" OR "authentication ERROR" OR "Failed password for"

[Failed_SU]
search= ("failed SU to another user" AND "Agent platform:" AND "linux-x86") OR ("failed SU to another user" AND "authentication failure" AND "for su service") OR ("failed SU to another user" AND logname=*) OR (exe="/bin/su" AND res="failed") OR (FAILED su for) OR (source="/var/adm/sulog" SU "-") OR ("BAD SU ")

[nix-all-logs]
search = source="*.log" OR source="*.log.*" OR source="*/log/*" OR source="/var/adm/*" OR source="access*" OR source="*error*" OR sourcetype="syslo*" NOT source=usersWithLoginPrivs NOT sourcetype=lastlog 

###### END FROM UNIX APP ######

###### Scripted Inputs ######

## Global

[solaris_scripted_input]
search = sourcetype=Solaris:*
#tags = check report

[unix_scripted_input]
search = sourcetype=Unix:*
#tags = check report

## Listening Ports
[solaris_listeningports]
search = sourcetype=solaris:openPorts
#tags = os config report listening port

## Local Processes
[solaris_localprocesses]
search = souretype=solaris:ps
#tags = os avail process

[solaris_localprocesses_anomalous]
search = sourcetype=solaris:cpu (cpu_load_percent>50 OR PercentMemory>50) NOT app=Total
#tags = anomalous

[sshd_insecure]
search = sshd_protocol=*1*
#tags = insecure

[update_status]
search = sourcetype=*:Update NOT total_updates
#tags = status


